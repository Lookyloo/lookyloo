{% if error %}
{{error}}
{%else%}
<div>
  <form role="form" action="{{ url_for('bulk_captures', base_tree_uuid=base_tree_uuid) }}" method=post enctype=multipart/form-data>
    <div class="mb-3">
      <label for="user_urls" class="form-label">Arbitrary URLs to capture in current context (with cookies)</label>
      <textarea class="form-control" id="user_urls" name="user_urls" rows="3"></textarea>
    </div>
    {% if guessed_urls %}
    <h4>URLs guessed during redirects:</h4>
    <hr>
    {% for url in guessed_urls %}
    <div class="form-check">
      <input class="form-check-input" type="checkbox" name="guessed_url" id="guest_url_{{loop.index}}" value="{{loop.index}}">
      <label class="form-check-label text-wrap text-break" for="guessed_url_{{loop.index}}">{{url}}</label>
    </div>
    {% endfor %}
    <hr>
    {%endif%}
    <h4>URLs in the rendered page:</h4>
    <hr>
    {% for url in urls %}
    <div class="form-check">
      <input class="form-check-input" type="checkbox" name="url" id="url_{{loop.index}}" value="{{loop.index}}">
      <label class="form-check-label text-wrap text-break" for="url_{{loop.index}}">{{url}}</label>
    </div>
    {% endfor %}
    <button type="button" class="btn btn-secondary" id="toggleURLs" title="(un)select all URLs">
      Toggle selection
    </button>
    <hr>
    <button type="submit" class="btn btn-primary" id="btn-capture-urls">Capture selected URLs</button>
  </form>
</div>

<script nonce="{{ csp_nonce() }}">
  const toggleURLs = document.getElementById("toggleURLs");
  if (toggleURLs) {
    toggleURLs.addEventListener("click", function() {
      checkAllBoxes("url");
    });
  }
</script>
{%endif%}
